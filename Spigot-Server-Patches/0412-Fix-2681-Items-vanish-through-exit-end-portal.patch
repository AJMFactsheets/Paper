From 37d97c06625b94ceb6530b7962f4b5a0384c99fa Mon Sep 17 00:00:00 2001
From: AJMFactsheets <AJMFactsheets@gmail.com>
Date: Sat, 14 Dec 2019 23:50:11 -0600
Subject: [PATCH] Fix #2681 - Items vanish through exit end portal


diff --git a/src/main/java/net/minecraft/server/World.java b/src/main/java/net/minecraft/server/World.java
index 985f3037..ad9acef6 100644
--- a/src/main/java/net/minecraft/server/World.java
+++ b/src/main/java/net/minecraft/server/World.java
@@ -616,7 +616,7 @@ public abstract class World implements GeneratorAccess, AutoCloseable {
         int k;
 
         if (i >= -30000000 && j >= -30000000 && i < 30000000 && j < 30000000) {
-            if (this.isChunkLoaded(i >> 4, j >> 4)) {
+            if (this.isChunkLoaded(i >> 4, j >> 4) || !this.keepSpawnInMemory) { // Paper - Fix #2681 - Items vanish through exit end portal
                 k = this.getChunkAt(i >> 4, j >> 4).a(heightmap_type, i & 15, j & 15) + 1;
             } else {
                 k = 0;
-- 
2.17.1

